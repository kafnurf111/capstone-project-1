@extends('.head')

@section('main-contents')
    <div class="sidebars d-flex flex-row ">
        <div class="containers-sidebar flex-column"
            style="background-image: url(img/bg-side.png);
        background-repeat: no-repeat;
        background-position: center;">
            <!--- | Day 21-23 ~ 1st Hackathon Day 1-3 | --->
            <a href="#" class="a-btn-hackathon align-items-center collapsed py-2 active" data-bs-toggle="collapse"
                data-bs-target="#hackathon_1st_day_1-collapse" aria-expanded="true">
                <div class="align-items-center my-3">
                    <div class="col pd-right-col">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="w-100">
                                <h6 class="my-3 fw-bold h6-hackathon">Day 21 - 1st Hackathon Day 1</h6>
                            </div>
                            <div class="icon-chev-right">
                                <i class="bi bi-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            <li class="li-hackathon-day1 collapse my-3" id="hackathon_1st_day_1-collapse">
                <a href="/dashboard_hackathon-1st-day1" class="a-hackathon-meeting active">
                    <div class="icon-earmark"><i class="bi bi-file-earmark-text"></i></div>
                    <div class="text-earmark">
                        <h6 class="">Tugas Bukti Record Meeting Kelompok</h6>
                    </div>
                </a>
            </li>

            <a href="#" class="a-btn-hackathon align-items-center collapsed py-2" data-bs-toggle="collapse"
                data-bs-target="#hackathon_1st_day_2-collapse" aria-expanded="true">
                <div class="align-items-center my-3">
                    <div class="col pd-right-col">
                        <div class="d-flex justify-content-between align-items-center w-100">
                            <div class="w-100">
                                <h6 class="my-3 fw-bold h6-hackathon">Day 22 - 1st Hackathon Day 2</h6>
                            </div>
                            <div class="icon-chev-right">
                                <i class="bi bi-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            <li class="li-hackathon-day1 collapse my-3" id="hackathon_1st_day_2-collapse">
                <a href="/dashboard_hackathon-1st-day2" class="a-hackathon-meeting">
                    <div class="icon-earmark"><i class="bi bi-file-earmark-text"></i></div>
                    <div class="text-earmark">
                        <h6 class="">Tugas Bukti Record Meeting Kelompok</h6>
                    </div>
                </a>
            </li>
            <a href="#" class="a-btn-hackathon align-items-center collapsed py-2" data-bs-toggle="collapse"
                data-bs-target="#hackathon_1st_day_3-collapse" aria-expanded="true">
                <div class="align-items-center my-3">
                    <div class="col pd-right-col">
                        <div class="d-flex justify-content-between align-items-center w-100">
                            <div class="w-100">
                                <h6 class="my-3 fw-bold h6-hackathon">Day 23 - 1st Hackathon Day 3</h6>
                            </div>
                            <div class="icon-chev-right">
                                <i class="bi bi-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            <li class="li-hackathon-day1 collapse my-3" id="hackathon_1st_day_3-collapse">
                <a href="#" class="a-hackathon-meeting">
                    <div class="icon-earmark"><i class="bi bi-file-earmark-text"></i></div>
                    <div class="text-earmark">
                        <h6 class="">Tugas Bukti Record Meeting Kelompok</h6>
                    </div>
                </a>
            </li>

            <!--- | Day 42-44 ~ 2nd Hackathon Day 1-3 | --->
            <a href="#" class="a-btn-hackathon align-items-center collapsed py-2" data-bs-toggle="collapse"
                data-bs-target="#hackathon_2nd_day_1-collapse" aria-expanded="true">
                <div class="align-items-center my-3">
                    <div class="col pd-right-col">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="w-100">
                                <h6 class="my-3 fw-bold h6-hackathon">Day 42 - 2nd Hackathon Day 1</h6>
                            </div>
                            <div class="icon-chev-right">
                                <i class="bi bi-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            <li class="li-hackathon-day1 collapse my-3" id="hackathon_2nd_day_1-collapse">
                <a href="#" class="a-hackathon-meeting">
                    <div class="icon-earmark"><i class="bi bi-file-earmark-text"></i></div>
                    <div class="text-earmark">
                        <h6 class="">Tugas Bukti Record Meeting Kelompok</h6>
                    </div>
                </a>
            </li>

            <a href="#" class="a-btn-hackathon align-items-center collapsed py-2" data-bs-toggle="collapse"
                data-bs-target="#hackathon_2nd_day_2-collapse" aria-expanded="true">
                <div class="align-items-center my-3">
                    <div class="col pd-right-col">
                        <div class="d-flex justify-content-between align-items-center w-100">
                            <div class="w-100">
                                <h6 class="my-3 fw-bold h6-hackathon">Day 43 - 2nd Hackathon Day 2</h6>
                            </div>
                            <div class="icon-chev-right">
                                <i class="bi bi-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            <li class="li-hackathon-day1 collapse my-3" id="hackathon_2nd_day_2-collapse">
                <a href="#" class="a-hackathon-meeting">
                    <div class="icon-earmark"><i class="bi bi-file-earmark-text"></i></div>
                    <div class="text-earmark">
                        <h6 class="">Tugas Bukti Record Meeting Kelompok</h6>
                    </div>
                </a>
            </li>
            <a href="#" class="a-btn-hackathon align-items-center collapsed py-2" data-bs-toggle="collapse"
                data-bs-target="#hackathon_2nd_day_3-collapse" aria-expanded="true">
                <div class="align-items-center my-3">
                    <div class="col pd-right-col">
                        <div class="d-flex justify-content-between align-items-center w-100">
                            <div class="w-100">
                                <h6 class="my-3 fw-bold h6-hackathon">Day 44 - 2nd Hackathon Day 3</h6>
                            </div>
                            <div class="icon-chev-right">
                                <i class="bi bi-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            <li class="li-hackathon-day1 collapse my-3" id="hackathon_2nd_day_3-collapse">
                <a href="#" class="a-hackathon-meeting">
                    <div class="icon-earmark"><i class="bi bi-file-earmark-text"></i></div>
                    <div class="text-earmark">
                        <h6 class="">Tugas Bukti Record Meeting Kelompok</h6>
                    </div>
                </a>
            </li>
        </div>
    </div>
    <div class="content-discussion"
        style="
    background-image: url(img/logoOnlyMaxy.png);
    background-position: center;
    background-repeat: no-repeat;">
        <div
            style="margin: 1rem 0 1rem 0;
        display:flex;
        border-bottom: 0.1rem solid;
        flex-direction: row;
        justify-content: space-between;
        align-items: flex-start;">
            <div style="margin-bottom: 10px;">
                <div style="display: flex; align-items: center; margin-bottom: 9px;">
                    <a href="#" style="color: black"><i class="chevron left icon"></i></a>
                    <a href="#" style="color: black"><i class="chevron right icon"></i></a>
                    <h3 class="discussions" style="margin: 0 0 0 10px;">Discussions</h3>
                </div>
                <span> Nama Diskusi</span>
            </div>
            <div class="d-flex">
                <a class="upload-task" onclick="openPopupUploadFile()">
                    <span>Upload Tugas</span>
                    <div class="icons-upload">
                        <i class="upload icon uploads-icon"></i>
                    </div>
                </a>
                <a type="button" id="close-icon" style="margin-right: 1rem">
                    <i class="close icon"></i>
                </a>
            </div>
        </div>
        <div class="messages-container" id="messages-container">
            <div class="message-list" id="message-list">
                <span>Belum Ada Percakapan</span>
            </div>
        </div>
        <footer class="message-form">
            <div class="btn-group dropup">
                <a class="button-plus" id="plus-icon" href="#" type="button" data-bs-toggle="dropdown"
                    aria-expanded="false">
                    <i class="plus icon"></i>
                </a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="#" class="dropdown-item dropdown-icon">
                            <i class="file alternate icon dd-icon file-style"></i>
                            <span>Dokumen</span>
                        </a>
                        <a href="#" class="dropdown-item dropdown-icon">
                            <i class="images icon dd-icon images-style"></i>
                            <span>Foto & Video</span>
                        </a>
                    </li>
                </ul>
            </div>
            <textarea class="textarea-control" id="comment" rows="1" placeholder="Tambahkan Komentar..."></textarea>
            <a class="button-send" type="button">
                <span>
                    <svg viewBox="0 0 24 24" height="24" width="24" preserveAspectRatio="xMidYMid meet"
                        class="" version="1.1" x="0px" y="0px" enable-background="new 0 0 24 24">
                        <path fill="currentColor"
                            d="M1.101,21.757L23.8,12.028L1.101,2.3l0.011,7.912l13.623,1.816L1.112,13.845 L1.101,21.757z">
                        </path>
                    </svg>
                </span>
            </a>
        </footer>
    </div>

    <!-- Popup Upload File Task -->
    <div class="popup-uploadfile" id="popup-uploadfile">
        <div class="overlay" id="overlay" onclick="closePopupUploadFIle()"></div>
        <div class="tasks" id="tasks">
            <div class="card card-member-list">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div></div>
                        <h3
                            style="margin: 0; background-color: #1533B5; color: #fff; padding: 5px; font-size: 20px; border-radius: 0.325rem">
                            Upload
                            Tugas</h3>
                        <a type="button" id="close-icon-uploadfile" style="" onclick="closePopupUploadFile()">
                            <i class="close icon"></i>
                        </a>
                    </div>

                    <form class="formUploadFile" action="" method="POST">
                        @csrf
                        <div class="modal-body text-center">
                            <div class="upload-area" style="display: flex; flex-direction: column;">
                                <div class="upload-icon" style="margin-bottom: 10px">
                                    <img src="{{ asset('img/upload_background.png') }}" alt="Upload Icon"
                                        style="width: 15rem;">
                                </div>
                                <input class="form-control" type="file" name="file" id="file" required>
                                <label for="file" class="form-label">Jelajah atau tarik file ke sini</label>
                            </div>
                        </div>
                        {{-- <input type="file" name="namafile"> --}}
                    </form>
                </div>
                {{-- <div class="container mt-5">
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#uploadModal">
                        Upload Tugas
                    </button>

                    @if (session('success'))
                        <div class="alert alert-success mt-3">
                            {{ session('success') }}
                            <div class="uploaded-file mt-2">
                                <i class="bi bi-file-earmark"></i>
                                {{ session('fileName') }}
                                <a href="{{ Storage::url(session('filePath')) }}" target="_blank">View</a>
                            </div>
                        </div>
                    @endif
                </div>

                <!-- Modal -->
                <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <form action="#" method="POST" enctype="multipart/form-data">
                                @csrf
                                <div class="modal-header">
                                    <h5 class="modal-title" id="uploadModalLabel">Upload Tugas</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body text-center">
                                    <div class="upload-area">
                                        <div class="upload-icon">
                                            <img src="{{ asset('img/upload_background.png') }}" alt="Upload Icon">
                                        </div>
                                        <label for="file" class="form-label">Jelajah atau tarik file ke sini</label>
                                        <input class="form-control" type="file" name="file" id="file"
                                            required>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Upload</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div> --}}
            </div>
        </div>
    </div>

    <script>
        document.getElementById('plus-icon').addEventListener('click', function() {
            this.querySelector('.plus.icon').classList.toggle('rotate-icon');
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mengatur Pusher
            Pusher.logToConsole = true;

            var pusher = new Pusher('{{ env('PUSHER_APP_KEY') }}', {
                cluster: '{{ env('PUSHER_APP_CLUSTER') }}'
            });

            var channel = pusher.subscribe('chat');
            channel.bind('App\\Events\\ChatMessage', function(data) {
                var messageList = document.getElementById('message-list');
                var messageElement = document.createElement('div');
                messageElement.className = 'message';
                messageElement.textContent = data.message;
                messageList.appendChild(messageElement);
                messageList.scrollTop = messageList.scrollHeight;
            });

            // Mengirim Pesan
            document.querySelector('.button-send').addEventListener('click', function() {
                var messageInput = document.getElementById('comment');
                var message = messageInput.value;

                axios.post('/send-message', {
                        message: message
                    })
                    .then(function(response) {
                        messageInput.value = '';
                        resetTextareaHeight();
                    })
                    .catch(function(error) {
                        console.log(error);
                    });
            });

            // Menangani textarea yang bisa berkembang
            var comment = document.getElementById('comment');
            var initialHeight = 40; // Set the initial height of the textarea
            var maxHeight = 150; // Set the max height for the textarea

            comment.style.height = initialHeight;

            comment.addEventListener('input', function() {
                // Reset height to initial height before calculating new height
                this.style.height = initialHeight + 'px';
                var newHeight = this.scrollHeight;

                if (newHeight > maxHeight) {
                    newHeight = maxHeight;
                    this.style.overflowY = 'auto'; // Enable scrolling if max height is reached
                } else {
                    this.style.overflowY = 'hidden'; // Hide scrollbar if below max height
                }

                this.style.height = newHeight + 'px';

                // If the textarea is empty, reset to the initial height
                if (this.value === '') {
                    this.style.height = initialHeight + 'px';
                    this.style.overflowY = 'hidden';
                }
            });

            function resetTextareaHeight() {
                comment.style.height = initialHeight + 'px';
                comment.style.overflowY = 'hidden';
            }
        });
    </script>
    <script src="https://js.pusher.com/7.0/pusher.min.js"></script>
@endsection
